

@model Minenetred.web.ViewModels.ProjectsViewModel

@{
    ViewData["Title"] = "ProjectsList";
}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $('#date').change(function () {
            if ($('.datesTable').css('display') == 'none') {
                $('.datesTable').toggle("slide");
            }
            var valueDate = new Date($('#date').val());
            valueDate.setDate(valueDate.getDate() + 1);
            $('.tableHeader').each(function (i, obj) {
                $(this).html(valueDate);
                valueDate.setDate(valueDate.getDate() + 1);
            });
        });

        $('.btn-add-entry').click(function () {
            var projectName = $(this).parent("td").parent("tr").find("td:first").text();
            $('#modalProjectTitle').text(projectName);
            var hiddenDate = $(this).parent("td").closest('table').find('th').eq($(this).parent("td").index()).text();
            $('#dateEntry').val(hiddenDate);
            $('#dateText').text('Date: ' + hiddenDate);
            var projectId = $(this).parent("td").parent("tr").find("td:first").find('input').val();
            $('#projectIdInput').val(projectId);
        });
    });
</script>


<h2>My open projects</h2>

<hr />
<div class="container">
    <div class="row">
        <div>
            @Html.Label("Select the starting day of the week", null, new { @class = "control-label col-xs-3" })
            <div class="col-xs-3">
                <input type="date" id="date" />
            </div>
        </div>
    </div>
</div>
<hr />
<div class="container container-fluid datesTable" style="display: none">
    <table class="table table-responsive table-striped" id="table">
        <thead>
            <tr>
                <th scope="col">Project:</th>
                <th class="tableHeader"></th>
                <th class="tableHeader"></th>
                <th class="tableHeader"></th>
                <th class="tableHeader"></th>
                <th class="tableHeader"></th>

            </tr>
        </thead>

        <tbody>
            @foreach (var project in Model.Projects)
            {
                <tr>
                    <td scope="row" style="width:25%">
                        @project.Name
                        <input type="hidden" id="@project.Name" value="@project.Id">

                    </td>
                    <td scope="row">
                        Total hours: 0
                        <button type="button" class="btn btn-success btn-add-entry"  data-toggle="modal" data-target="#timeEntryForm">
                            Add time entry
                        </button>
                    </td>
                    <td scope="row">
                        Total hours: 0
                        <button type="button" class="btn btn-success btn-add-entry" data-toggle="modal" data-target="#timeEntryForm">
                            Add time entry
                        </button>
                    </td>
                    <td scope="row">
                        Total hours: 0
                        <button type="button" class="btn btn-success btn-add-entry" data-toggle="modal" data-target="#timeEntryForm">
                            Add time entry
                        </button></td>
                    <td scope="row">
                        Total hours: 0
                        <button type="button" class="btn btn-success btn-add-entry" data-toggle="modal" data-target="#timeEntryForm">
                            Add time entry
                        </button></td>
                    <td scope="row">
                        Total hours: 0
                        <button type="button" class="btn btn-success btn-add-entry" data-toggle="modal" data-target="#timeEntryForm">
                            Add time entry
                        </button></td>
                </tr>
            }
        <tr>
            <td scope="row" style="width:25%">Total hours per day</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
        </tr>
        </tbody>
    </table>
</div>

<!-- Modal -->
<div class="modal fade" id="timeEntryForm" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalProjectTitle"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group input-group">
                    <form action="/" method="post">
                        <input id="projectIdInput" type="hidden" name="projectId" value="" />
                        <input class="input-group" type="number" min="0" name="hours" placeholder="Enter hours" /><br />
                        <input class="input-group" type="text" name="description" placeholder="Enter description" /><br />
                        <select class="input-group" name="issue">
                            <option value="3">Project Activities</option>
                        </select><br />
                        <select class="input-group" name="activity">
                            <option value="2">Development</option>
                        </select><br />
                        <input id="dateEntry" type="hidden" name="date" value="" />
                        <text class="input-group" id="dateText">Date: </text><br />
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>



